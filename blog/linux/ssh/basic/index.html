<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">

<head>
    <meta name="generator" content="Hugo 0.56.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/css/theme_scrapbook.css" />
    <link rel="start" href="https://wellfrog27.github.io" title="Home" />
    <link rel='icon' type='image/x-icon' href="/favicon.ico" />
    

    <title>SSH 基本知识 - 阮一峰的网络日志</title>
    <link rel="stylesheet" href="/css/custom.css" />
    
    <script src="/js/click_enlarge_image.js"></script>
    





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>


<body id="scrapbook" class="mt-entry-archive one-column">

    <div id="container">
        <div id="container-inner">
<div id="header">
    <div id="header-inner">
        <div id="header-content">
            
            <div id="header-name">
                阮一峰的网络日志
                
                <span>» <a href="/blog/" title="首页">首页</a></span>
                
                <span>» <a href="/blog/archives/" title="档案">档案</a></span>
                
            </div>
            
            <div id="google_search" style="background-image:url('/images/searchtop.gif');">
                
                <form action="https://www.baidu.com/s" target="_blank" method="get" id="cse-search-box">
                    <div>
                        <input type="text" size="20" name="origin" class="searchbox" id="sbi" value="">
                        <input type="hidden" name="wd" value="">
                        
                        <input type="image" src="/images/top_search_submit.gif" class="searchbox_submit" value=""
                            alt="搜索" name="sa" onclick="this.form.wd.value = this.form.origin.value + ' 阮一峰'">
                    </div>
                </form>

                
            </div>
            <div id="feed_icon">
                
            </div>

        </div>
    </div>

</div>



<div id="content">
    <div id="content-inner">
        <div id="alpha">
            <div id="alpha-inner">

                <div id="entry-1983" class="entry-asset asset hentry">

                    <div class="asset-header">
                        <div class="asset-nav entry-nav">

                            <div class="entry-location">
                                <ul>
                                    
                                    <li>上一篇：<a href="https://wellfrog27.github.io/blog/vim/plugins/netrw/"
                                            title="netrw 插件">netrw 插件</a>
                                    </li>
                                    

                                    
                                    <li>下一篇：<a href="https://wellfrog27.github.io/blog/javascript/testing/"
                                            title="JavaScript测试">JavaScript测试</a>
                                    </li>
                                    

                                </ul>
                            </div>



                            <div class="entry-categories">
                                <p>分类<span class="delimiter">：</span></p>
                                <ul>
                                    <li><a href="https://wellfrog27.github.io/blog/linux/"
                                            rel="tag">Linux</a></li>
                                </ul>
                            </div>




                            <div class="entry-location-mobile" style="float: right;">
                                <ul>
                                    
                                    <li><a href="https://wellfrog27.github.io/blog/vim/plugins/netrw/" title="netrw 插件">⇐</a></li>
                                    
                                    
                                    <li><a href="https://wellfrog27.github.io/blog/javascript/testing/" title="JavaScript测试">⇒</a></li>
                                    
                                </ul>
                            </div>

                        </div>
                    </div>

                    <article class="hentry">
                        <h1 id="page-title" class="asset-name entry-title">SSH 基本知识</h1>
                        
                        
                        

                        <div class="asset-meta">
                            <p class="vcard author">作者： <a class="fn url" href="/">
                                    
                                    阮一峰
                                    
                                </a></p>
                            <p>日期： <a href="https://wellfrog27.github.io/blog/linux/"><abbr class="published"
                                        title=2014-12-04&#32;00:00:00&#32;&#43;0000&#32;UTC>2014年12月4日</abbr></a>
                            </p>
                        </div>

                        <div class="asset-content entry-content" id="main-content">
                            

<p>SSH（Secure Shell 的缩写）是一种加密网络协议，用于客户端和服务器之间的安全连接，并支持各种身份验证机制。</p>

<p>两种最流行的机制是基于密码的身份验证和基于公钥的身份验证。后者比传统的密码验证更安全，更方便。</p>

<h2 id="密钥">密钥</h2>

<p>用户的密钥一般都放在主目录的<code>.ssh</code>目录里面。</p>

<p>下面的命令列出用户所有的公钥。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -l ~/.ssh/id_*.pub</code></pre></td></tr></table>
</div>
</div>
<p>如果不存在任何密钥，可以手动生成一个。下面命令生成一个新的4096位 SSH 密钥对，并将指定的电子邮件地址作为注释。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh-keygen -t rsa -b <span style="color:#b452cd">4096</span> -C <span style="color:#cd5555">&#34;your_email@domain.com&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>这时，系统会提示输入密钥的位置和文件名，用户可以选择接受默认设置。另外，还会提示是否对密钥设置口令保护（passphrase）。</p>

<h2 id="ssh-copy-id-命令">ssh-copy-id 命令</h2>

<p>为了登录远程服务器，需要把用户的个人密钥拷贝到服务器。<code>ssh-copy-id</code>就用于把本地密钥复制到远程服务器。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh-copy-id remoteusername@server_ip_address</code></pre></td></tr></table>
</div>
</div>
<p>这时，系统会提示输入远程服务器的密码。</p>

<p>用户通过身份验证后，公钥<code>~/.ssh/id_rsa.pub</code>将复制到远程用户的<code>~/.ssh/authorized_keys</code>文件，并将关闭连接。</p>

<p>如果没有安装<code>ssh-copy-id</code>命令，可以用下面的命令代替。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat ~/.ssh/id_rsa.pub | ssh remoteusername@server_ip_address <span style="color:#cd5555">&#34;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>上面命令的作用就是将本地用户的公钥，写入远程的<code>~/.ssh/authorized_keys</code>文件。</p>

<h2 id="ssl-tls-协议">SSL/TLS 协议</h2>

<p>客户端要向服务端提供一些加密参数，这叫做“加密集”（cipher suite）。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">TLS_RSA_WITH_AES_128_CBC_SHA</pre></td></tr></table>
</div>
</div>
<p>含义如下。</p>

<ul>
<li>TLS：协议</li>
<li>RSA：密钥交换算法</li>
<li>AES：加密算法</li>
<li>128：加密强度</li>
<li>CBC：加密模式</li>

<li><p>SHA：数字签名的Hash函数</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#a61717;background-color:#e3d2d2">Handshake protocol: ClientHello
</span><span style="color:#a61717;background-color:#e3d2d2">Version: TLS 1.2
</span><span style="color:#a61717;background-color:#e3d2d2">Random
</span><span style="color:#a61717;background-color:#e3d2d2">    Client time: May 22, 2030 02:43:46 GMT
</span><span style="color:#a61717;background-color:#e3d2d2">    Random bytes: b76b0e61829557eb4c611adfd2d36eb232dc1332fe29802e321ee871
</span><span style="color:#a61717;background-color:#e3d2d2">Session ID: (empty)
</span><span style="color:#a61717;background-color:#e3d2d2">Cipher Suites
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256”
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_RSA_WITH_AES_128_GCM_SHA256
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_DHE_RSA_WITH_AES_128_CBC_SHA
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_RSA_WITH_AES_128_CBC_SHA
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_RSA_WITH_3DES_EDE_CBC_SHA
</span><span style="color:#a61717;background-color:#e3d2d2">    Suite: TLS_RSA_WITH_RC4_128_SHA
</span><span style="color:#a61717;background-color:#e3d2d2">Compression methods
</span><span style="color:#a61717;background-color:#e3d2d2">    Method: null
</span><span style="color:#a61717;background-color:#e3d2d2">Extensions
</span><span style="color:#a61717;background-color:#e3d2d2">    Extension: server_name
</span><span style="color:#a61717;background-color:#e3d2d2">        Hostname: www.feistyduck.com
</span><span style="color:#a61717;background-color:#e3d2d2">    Extension: renegotiation_info
</span><span style="color:#a61717;background-color:#e3d2d2">    Extension: elliptic_curves
</span><span style="color:#a61717;background-color:#e3d2d2">        Named curve: secp256r1
</span><span style="color:#a61717;background-color:#e3d2d2">        Named curve: secp384r1
</span><span style="color:#a61717;background-color:#e3d2d2">    Extension: signature_algorithms
</span><span style="color:#a61717;background-color:#e3d2d2">        Algorithm: sha1/rsa
</span><span style="color:#a61717;background-color:#e3d2d2">        Algorithm: sha256/rsa
</span><span style="color:#a61717;background-color:#e3d2d2">        Algorithm: sha1/ecdsa
</span><span style="color:#a61717;background-color:#e3d2d2">        Algorithm: sha256/ecdsa”</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p>服务器回应</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#a61717;background-color:#e3d2d2">Handshake protocol: ServerHello
</span><span style="color:#a61717;background-color:#e3d2d2">    Version: TLS 1.2
</span><span style="color:#a61717;background-color:#e3d2d2">    Random
</span><span style="color:#a61717;background-color:#e3d2d2">        Server time: Mar 10, 2059 02:35:57 GMT”
</span><span style="color:#a61717;background-color:#e3d2d2">        Random bytes: 8469b09b480c1978182ce1b59290487609f41132312ca22aacaf5012
</span><span style="color:#a61717;background-color:#e3d2d2">    Session ID: 4cae75c91cf5adf55f93c9fb5dd36d19903b1182029af3d527b7a42ef1c32c80
</span><span style="color:#a61717;background-color:#e3d2d2">    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
</span><span style="color:#a61717;background-color:#e3d2d2">    Compression method: null
</span><span style="color:#a61717;background-color:#e3d2d2">    Extensions
</span><span style="color:#a61717;background-color:#e3d2d2">        Extension: server_name
</span><span style="color:#a61717;background-color:#e3d2d2">        Extension: renegotiation_info”</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="openssh">OpenSSH</h2>

<ul>
<li>ssh-keygen</li>
<li>ssh-agent</li>
<li>ssh-add</li>
<li>ssh-keysign</li>
<li>ssh-keyscan</li>
<li>sftp-server</li>
<li>sshd</li>
</ul>

<h3 id="生成密钥">生成密钥</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh-keygen -t rsa</code></pre></td></tr></table>
</div>
</div>
<p>密钥会在<code>~/.ssh</code>目录生成。</p>

<p>服务器安装OpenSSH服务器。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt-get install openssh-server

<span style="color:#228b22"># Ubuntu 15.04+</span>
$ systemctl restart ssh

<span style="color:#228b22"># Ubuntu 14.04</span>
$ service ssh restart</code></pre></td></tr></table>
</div>
</div>
<p>将本地密钥推送到服务器。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh-copy-id username@host</code></pre></td></tr></table>
</div>
</div>
<h3 id="命令行参数">命令行参数</h3>

<p><code>-4</code>：连接时使用 IPv4。</p>

<p><code>-6</code>：连接时使用 IPv6。</p>

<p><code>-C</code>：传输数据时采用压缩。</p>

<p><code>-D</code>：指定本机的 Socks 监听端口，该端口收到的请求，都将转发到远程的 SSH 主机。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh -D <span style="color:#b452cd">8888</span> user@remoteserver</code></pre></td></tr></table>
</div>
</div>
<p><code>-i</code>：指定登陆服务器所需要的私钥，意为“identity_file”，默认为<code>~/.ssh/id_dsa</code>。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh johndoe@host.example.com -i ~/.ssh/host.key</code></pre></td></tr></table>
</div>
</div>
<p><code>-L</code>：指定本地端口绑定。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh  -L <span style="color:#b452cd">9999</span>:targetServer:80 user@remoteserver</code></pre></td></tr></table>
</div>
</div>
<p>上面代码中，所有发向本地<code>9999</code>端口的请求，都会经过<code>remoteserver</code>发往 targetServer 的 80 端口，这就相当于直接连上了 targetServer 的 80 端口。</p>

<p><code>-p</code>：指定远程的端口，比如<code>-p 22</code>。</p>

<p><code>-R</code>：指定远程端口绑定。</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh -R <span style="color:#b452cd">9999</span>:targetServer:902 user@remoteserver</code></pre></td></tr></table>
</div>
</div>
<p>上面命令中，指定<code>remoteserver</code>监听自己的 9999 端口，所有发向这个端口的请求，都会转向 targetServer 的 902 端口。</p>

<p><code>-v</code>：输出详细的调试信息。</p>

                        </div>

                        <div class="asset-footer">
                            <h3>文档信息</h3>
                            <ul>
                                <li>版权声明：自由转载-非商用-非衍生-保持署名（<a
                                        href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">创意共享3.0许可证</a>）
                                </li>
                                <li>发表日期： <abbr class="published"
                                        title=".Date">2014年12月4日</abbr></li>
                            </ul>
                        </div>

                    </article>

                </div>

                
                
                <div id="related_entries">

                    <h2>相关文章</h2>
                    <ul>
                        
                        <li><strong>2019.07.15: <a href="https://wellfrog27.github.io/blog/linux/shells/fish-shell/"
                                    title="Fish Shell的用法">Fish Shell的用法</a></strong>

                            <div class="entry-body">
                                暂无描述，请点击阅读全文
                            </div>

                        </li>
                        
                        <li><strong>2019.06.26: <a href="https://wellfrog27.github.io/blog/linux/ssh/port-forwarding/"
                                    title="SSH 端口转发">SSH 端口转发</a></strong>

                            <div class="entry-body">
                                暂无描述，请点击阅读全文
                            </div>

                        </li>
                        
                        <li><strong>2019.03.30: <a href="https://wellfrog27.github.io/blog/linux/basic/"
                                    title="Linux的用法">Linux的用法</a></strong>

                            <div class="entry-body">
                                暂无描述，请点击阅读全文
                            </div>

                        </li>
                        
                        <li><strong>2019.03.09: <a href="https://wellfrog27.github.io/blog/linux/apache/config/"
                                    title="配置文件">配置文件</a></strong>

                            <div class="entry-body">
                                暂无描述，请点击阅读全文
                            </div>

                        </li>
                        
                    </ul>
                </div>
                

            </div>
        </div>
    </div>
</div>



<div id="click-img-container">
    <img src="" alt="Big Image">
</div>




<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "lin-hao-rong-de-wang-luo-ri-zhi" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<div id="footer">
  <div id="footer-inner">
    <div id="footer-content">
      <p>2019 &copy; <a title="电子邮件" href="mailto:yifeng.ruan@gmail.com" target="_blank">联系方式</a>
        
    </div>
  </div>
</div>
</div>
    </div>

    
    
</body>

</html>